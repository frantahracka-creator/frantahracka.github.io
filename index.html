<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPL Editor Ot√°zek - Fin√°ln√≠ verze</title>
    <style>
        :root {
            --primary: #2196f3;
            --success: #4caf50;
            --bg: #f4f4f9;
            --text: #333;
        }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            max-width: 900px; 
            margin: 0 auto; 
            padding: 20px;
            background-color: var(--bg);
            color: var(--text);
        }
        .card { 
            background: white; 
            padding: 30px; 
            border-radius: 12px; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.08); 
        }
        #progress { 
            font-size: 0.9em; 
            color: #666; 
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        h2 { margin-top: 0; line-height: 1.4; color: #1a237e; }
        .answer-container { margin: 25px 0; }
        .answer { 
            display: block; 
            width: 100%; 
            padding: 15px; 
            margin: 10px 0; 
            border: 2px solid #eee; 
            border-radius: 8px; 
            cursor: pointer; 
            text-align: left;
            background: white;
            font-size: 16px;
            transition: all 0.2s;
        }
        .answer:hover { border-color: var(--primary); background: #f0f7ff; }
        .answer.selected { 
            border-color: var(--success); 
            background: #e8f5e9; 
            font-weight: bold;
            box-shadow: inset 4px 0 0 var(--success);
        }
        .controls { 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        button.nav-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 6px;
            background: #e0e0e0;
            cursor: pointer;
            font-weight: bold;
        }
        button.nav-btn:hover { background: #d0d0d0; }
        .download-btn {
            padding: 12px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        .tip {
            margin-top: 20px;
            font-size: 0.85em;
            color: #888;
            text-align: center;
        }
        kbd {
            background: #eee;
            border-radius: 3px;
            padding: 2px 6px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>

    <div class="card">
        <div id="progress">Naƒç√≠t√°m ot√°zky...</div>
        <h2 id="questionText">Pros√≠m ƒçekejte, naƒç√≠t√°m soubor questions.json</h2>
        
        <div id="answerOptions" class="answer-container">
            </div>
        
        <div class="controls">
            <button class="nav-btn" onclick="prevQuestion()">‚¨Ö P≈òEDCHOZ√ç</button>
            <button class="download-btn" onclick="downloadJSON()">üíæ ST√ÅHNOUT JSON</button>
            <button class="nav-btn" onclick="nextQuestion()">DAL≈†√ç ‚û°</button>
        </div>

        <div class="tip">
            Kl√°vesy <kbd>1</kbd> <kbd>2</kbd> <kbd>3</kbd> <kbd>4</kbd> pro v√Ωbƒõr | <kbd>‚Üê</kbd> <kbd>‚Üí</kbd> pro pohyb
        </div>
    </div>

    <script>
        let questions = [];
        let currentIndex = 0;

        // 1. Naƒçten√≠ dat ze souboru
        fetch('questions.json')
            .then(res => {
                if (!res.ok) throw new Error("Soubor questions.json nenalezen!");
                return res.json();
            })
            .then(data => {
                questions = data;
                render();
            })
            .catch(err => {
                document.getElementById('questionText').innerHTML = 
                    "<span style='color:red'>Chyba: " + err.message + "</span><br><br>" +
                    "Ujistƒõte se, ≈æe soubor 'questions.json' je ve stejn√© slo≈æce jako tento HTML soubor.";
            });

        // 2. Vykreslen√≠ ot√°zky
        function render() {
            if (questions.length === 0) return;
            const q = questions[currentIndex];
            
            // Aktualizace text≈Ø
            document.getElementById('progress').innerText = `Ot√°zka ${currentIndex + 1} z ${questions.length} (ID: ${q.id})`;
            document.getElementById('questionText').innerText = q.question;
            
            const container = document.getElementById('answerOptions');
            container.innerHTML = '';
            
            // Generov√°n√≠ tlaƒç√≠tek odpovƒõd√≠
            q.answers.forEach((text, i) => {
                const b = document.createElement('button');
                b.className = 'answer';
                if (q.correct === i) b.classList.add('selected');
                
                // P≈ôid√°n√≠ textu odpovƒõdi
                b.innerText = text;
                
                // Logika kliknut√≠
                b.onclick = () => {
                    saveAnswer(i);
                };
                
                container.appendChild(b);
            });
        }

        // 3. Ulo≈æen√≠ odpovƒõdi
        function saveAnswer(index) {
            questions[currentIndex].correct = index;
            console.log(`Ulo≈æeno: Ot√°zka ${questions[currentIndex].id}, Odpovƒõƒè index ${index}`);
            render();
            // Automatick√Ω posun na dal≈°√≠ ot√°zku pro rychlost (voliteln√©)
            // setTimeout(nextQuestion, 200); 
        }

        // 4. Navigace
        function nextQuestion() {
            if (currentIndex < questions.length - 1) {
                currentIndex++;
                render();
                window.scrollTo(0, 0);
            }
        }

        function prevQuestion() {
            if (currentIndex > 0) {
                currentIndex--;
                render();
                window.scrollTo(0, 0);
            }
        }

        // 5. Kl√°vesov√© zkratky
        window.addEventListener('keydown', e => {
            if (e.key >= '1' && e.key <= '9') {
                const idx = parseInt(e.key) - 1;
                if (questions[currentIndex] && idx < questions[currentIndex].answers.length) {
                    saveAnswer(idx);
                }
            }
            if (e.key === 'ArrowRight') nextQuestion();
            if (e.key === 'ArrowLeft') prevQuestion();
        });

        // 6. Sta≈æen√≠ upraven√©ho souboru
        function downloadJSON() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(questions, null, 2));
            const downloadAnchorNode = document.createElement('a');
            downloadAnchorNode.setAttribute("href", dataStr);
            downloadAnchorNode.setAttribute("download", "Letecky_zakon_FIN√ÅLN√ç.json");
            document.body.appendChild(downloadAnchorNode);
            downloadAnchorNode.click();
            downloadAnchorNode.remove();
            alert("Soubor byl vygenerov√°n a sta≈æen.");
        }
    </script>
</body>
</html>